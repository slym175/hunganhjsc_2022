<?phpif (!class_exists('WP_NanoAjax')) {    class WP_NanoAjax    {        protected static $instance = null;        private $exclude_func = array('__construct', 'getInstance', 'register_ajax_action');        public function __construct()        {            $actions = get_class_methods('WP_NanoAjax');            foreach ($actions as $action) {                if (!in_array($action, $this->exclude_func))                    $this->register_ajax_action($action);            }        }        /**         * @return WP_NanoAjax         */        public static function getInstance()        {            if (self::$instance == null) {                self::$instance = new WP_NanoAjax();            }        }        function register_ajax_action($action_name = "")        {            if (!$action_name) return;            add_action('wp_ajax_' . $action_name, array($this, $action_name));            add_action('wp_ajax_nopriv_' . $action_name, array($this, $action_name));        }        public function customer_subcribe_action()        {            $response = "";            if (!wp_verify_none($_POST['_wpnonce'], 'customer_subcribe_action')) {                $response = ":(( Spam à!!";                wp_send_json_success($response);            }            if (isset($_POST['email']) && $_POST['email']) {                if (filter_var($_POST['email'], FILTER_VALIDATE_EMAIL)) {                    $to = get_bloginfo('admin_email') ? get_bloginfo('admin_email') : "thuyhu9876@gmail.com";                    $subject = "Phú Cường [Centalac] - Liên hệ/Đăng ký nhận tin";                    $message = "Khách hàng " . $_POST['email'] . " đăng ký nhận tin từ Centalac của bạn!!";                    $headers[] = 'Content-Type: text/html; charset=UTF-8';                    if (wp_mail($to, $subject, $message, $headers)) {                        $response = 'Đăng ký nhận tin thành công!';                    } else {                        $response = 'Có lỗi xảy ra trong quá trình đăng ký!';                    }                } else {                    $response = "Nhập email của bạn!";                }            } else {                $response = 'Vui lòng nhập đầy đủ thông tin!';            }            wp_send_json_success($response);            die();        }        public function load_more_diseases_action()        {            if (isset($_REQUEST['offset']) && $_REQUEST['offset'] && isset($_REQUEST['load_items']) && $_REQUEST['load_items']) {                $count = 0;                $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;                $arrg = array(                    'post_type' => 'post',                    'posts_per_page' => $_REQUEST['load_items'],                    'paged' => $paged,                    'offset' => $_REQUEST['offset']                );                if (isset($_REQUEST['cat']) && $_REQUEST['cat']) {                    $arrg['cat'] = $_REQUEST['cat'];                }                $posts = new WP_Query($arrg);                ob_start();                while ($posts->have_posts()) :                    $posts->the_post();                    get_template_part('template-parts/contents/posts/post-item-2', '', array('post' => get_the_ID()));                    $count++;                endwhile; // End of the loop.                $cont = ob_get_contents();                ob_clean();                ob_end_flush();                wp_send_json_success(array(                    'offset' => $_REQUEST['load_items'] + $_REQUEST['offset'],                    'html' => $cont,                    'count' => $count                ));            } else {                wp_send_json_error(array(                    'offset' => 0,                    'html' => $_REQUEST                ));            }            die();        }    }}